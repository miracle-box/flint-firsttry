---
import type { Locales, News, NewsPageProps as Props } from '~/types';
import Layout from '~/layouts/news-content.astro';
import { locales } from '~/utils/i18n';
import { fetchNews } from '~/utils/news';

const { contentProps } = Astro.props;

type Path = {
	params: {
		locale: Locales;
		slug: string;
	};
	props: {
		contentProps: News;
	};
};

export async function getStaticPaths() {
	const paths = [];
	const allPages = await fetchNews();

	for (const locale of locales) {
		const pages = allPages.map(
			(p): Path => ({
				params: { locale, slug: p.slug },
				props: { contentProps: p },
			}),
		);

		paths.push(...pages);
	}

	return paths;
}
---

<Layout contentProps={contentProps}>
	<contentProps.Content />
</Layout>
